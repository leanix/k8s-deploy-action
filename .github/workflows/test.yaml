name: Test k8s deploy
on: [push]

jobs:
  test:
    name: Test Deployment
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Get credentials
        uses: leanix/secrets-action@master
        with:
          secret-store-credentials: ${{ secrets.INJECTED_SECRET_STORE_CREDENTIALS }}

      - name: Use k8s deploy action
        uses: ./
        with:
          k8s_template_directory: test/k8s
          k8s_namespace: k8s-deploy-test
          k8s_environment: test
          k8s_version: ${{ github.run_number }}